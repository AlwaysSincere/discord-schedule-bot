# Discord Schedule Bot - 키워드 분석 모드
name: Keyword Analysis Mode

# 언제 실행할지 설정
on:
  # 수동으로 실행할 수 있게 설정 (테스트용)
  workflow_dispatch:
  
  # 나중에 자동 실행을 위한 스케줄 (현재는 주석 처리)
  # schedule:
  #   - cron: '0 9 * * *'  # 매일 오전 9시 (한국시간 오후 6시)

# 실행할 작업들
jobs:
  keyword-analysis:
    runs-on: ubuntu-latest  # Ubuntu 리눅스 환경에서 실행
    
    steps:
    # 1단계: 코드 다운로드
    - name: 📥 코드 체크아웃
      uses: actions/checkout@v4
    
    # 2단계: Python 설치
    - name: 🐍 Python 설정
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    # 3단계: 필요한 패키지 설치
    - name: 📦 패키지 설치
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    # 4단계: 키워드 분석 모드 실행 (OpenAI API 사용 안함)
    - name: 🔍 키워드 분석 모드 실행
      env:
        DISCORD_TOKEN: ${{ secrets.DISCORD_TOKEN }}
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }}
        CALENDAR_ID: ${{ secrets.CALENDAR_ID }}
        ANALYSIS_MODE: 'true'  # 키워드 분석만 실행
      run: |
        echo "키워드 분석 모드를 시작합니다 (OpenAI API 사용 안함)..."
        cd src
        python main.py
