# Discord Schedule Bot - ì „ì²´ ì‹œìŠ¤í…œ ì‹¤í–‰
name: Full Schedule Extraction

# ì–¸ì œ ì‹¤í–‰í• ì§€ ì„¤ì •
on:
  # ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ì„¤ì • (í…ŒìŠ¤íŠ¸ìš©)
  workflow_dispatch:
  
  # ë‚˜ì¤‘ì— ìë™ ì‹¤í–‰ì„ ìœ„í•œ ìŠ¤ì¼€ì¤„ (í˜„ì¬ëŠ” ì£¼ì„ ì²˜ë¦¬)
  # schedule:
  #   - cron: '0 9 * * *'  # ë§¤ì¼ ì˜¤ì „ 9ì‹œ (í•œêµ­ì‹œê°„ ì˜¤í›„ 6ì‹œ)

# ì‹¤í–‰í•  ì‘ì—…ë“¤
jobs:
  full-schedule-extraction:
    runs-on: ubuntu-latest  # Ubuntu ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì—ì„œ ì‹¤í–‰
    
    steps:
    # 1ë‹¨ê³„: ì½”ë“œ ë‹¤ìš´ë¡œë“œ
    - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4
    
    # 2ë‹¨ê³„: Python ì„¤ì¹˜
    - name: ğŸ Python ì„¤ì •
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    # 3ë‹¨ê³„: í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
    - name: ğŸ“¦ íŒ¨í‚¤ì§€ ì„¤ì¹˜
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    # 4ë‹¨ê³„: ì „ì²´ ì‹œìŠ¤í…œ ì‹¤í–‰ (Discord â†’ AI â†’ Calendar)
    - name: ğŸš€ ì¼ì • ìë™ ì¶”ì¶œ ì‹œìŠ¤í…œ ì‹¤í–‰
      env:
        DISCORD_TOKEN: ${{ secrets.DISCORD_TOKEN }}
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }}
        CALENDAR_ID: ${{ secrets.CALENDAR_ID }}
        # ANALYSIS_MODE: 'true'  # ì£¼ì„ ì²˜ë¦¬ë¡œ ì „ì²´ ëª¨ë“œ í™œì„±í™”
      run: |
        echo "ì „ì²´ ì¼ì • ì¶”ì¶œ ì‹œìŠ¤í…œì„ ì‹œì‘í•©ë‹ˆë‹¤ (Discord â†’ AI â†’ Calendar)..."
        cd src
        python main.py
